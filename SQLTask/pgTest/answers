select * from books order by code_book ;
select code_book, title_book, pages from books order by title_book, pages;
select name_company,   phone,  inn from deliveries order by inn desc;
select * from deliveries where name_company like '%к%к%' and name_company not like '%а' order by code_delivery;
select * from publishing_house order by code_publish desc;
select city, publish from publishing_house order by publish;
select title_book, pages, (select name_author from authors where authors.code_author=books.code_author) as name_author from books order by code_book;
select title_book, pages, (select publish from publishing_house where code_publish=books.code_publish) as publish from books order by code_book;
select title_book, pages, (select publish from publishing_house where code_publish=books.code_publish) as publish, (select city from publishing_house where code_publish=books.code_publish) as city from books order by code_book;
select name_company, phone, inn from deliveries where name_company like 'к%' order by code_delivery;
select title_book, pages, (select name_author from authors where authors.code_author=books.code_author) as name_author from books where title_book like 'золотые %' order by code_book;
select name_author from authors where name_author like 'януш%';
select publish from publishing_house where not city = 'москва' order by code_publish;
select title_book from books where not code_publish = (select code_publish from publishing_house where publish='пулковское') order by code_book;
select name_author from authors where birthday between date('1959-01-12') and date('1973-12-18') order by code_author;
select (select title_book from books where purchases.code_book = books.code_book) as title_book, amount from purchases where date_order between date('2012-08-06') and date('2015-02-12') order by amount desc, code_book;
select name_author from authors where code_author not in (select code_author from books) order by name_author desc;
select name_author from authors where code_author in (select code_author from books group by code_author having count(*)>1) order by code_author;
select (select count(*) from books)/(select count(*) from authors) as srednee;
select sum(cost*amount) as viruchka from purchases where code_delivery in (select code_delivery from deliveries where address like '%ташкент%' );
select sum(cost*amount) as viruchka from purchases where code_book in (select code_book from books where pages>400);
select * from books where code_book in (select code_book from purchases group by code_book having count(*)=(select count(*) from purchases group by code_book order by count(*) desc limit 1)) order by code_book;
select * from books where code_book not in (select code_book from purchases group by code_book having count(*)=(select count(*) from purchases group by code_book order by count(*) desc limit 1)) order by code_book;
select * from books where code_book not in (select code_book from purchases) order by code_book;
select * from books where code_book in (select code_book from purchases group by code_book having count(*)=(select count(*) from purchases group by code_book order by count(*) limit 1)) order by code_book;
select * from books where code_book not in (select code_book from purchases group by code_book having count(*)=(select count(*) from purchases group by code_book order by count(*) limit 1)) and code_book not in (select code_book from purchases) order by code_book;
select substring_index(name_author, ' ', 2) as fi from authors limit 5;
select substring_index(name_author, ' ', -2) as io from authors limit 6;
select substring_index(name_author, ' ', 1) as familiya from authors order by code_author desc limit 1;
select code_purchase from purchases where cost*amount=(select cost*amount from purchases order by cost*amount desc limit 1);
select type_purchase, count(*) as kolichestvo from purchases group by type_purchase having count(*)=(select count(*) as kolichestvo from purchases group by type_purchase order by count(*) desc limit 1);
select type_purchase, count(*) as kolichestvo from purchases group by type_purchase having count(*)=(select count(*) as kolichestvo from purchases group by type_purchase order by count(*)  limit 1);
select year(date_order) as god, count(*) as kolichestvo from purchases group by year(date_order) having count(*)=(select count(*) from purchases group by year(date_order) order by count(*) desc limit 1) order by year(date_order);
select year(date_order) as god, count(*) as kolichestvo from purchases group by year(date_order) having count(*)=(select count(*) from purchases group by year(date_order) order by count(*) limit 1) order by year(date_order);
select year(date_order) as god, count(*) as kolichestvo from purchases where year(date_order) not in (2009,2010,2011,2012) group by year(date_order) order by year(date_order) ;
select month(date_order) as month, count(*) as kolichestvo from purchases group by year(date_order) having count(*)=(select count(*) from purchases group by year(date_order) order by count(*) desc limit 1) order by  month(date_order) desc;
select distinct month(date_order) as month, count(*) as kolichestvo from purchases group by year(date_order) having count(*)=(select count(*) from purchases group by year(date_order) order by count(*) limit 1) order by month;
select sum(cost*amount) as viruchka from purchases where type_purchase like "%розница%";
select sum(cost*amount) as viruchka from purchases where type_purchase like "%оптом%";
select ((select sum(cost*amount) as viruchka from purchases where type_purchase like "%оптом%")-(select sum(cost*amount) as viruchka from purchases where type_purchase like "%розница%")) as raznica;
select name_company, address from deliveries where code_delivery not in (select code_delivery from purchases) order by code_delivery;
select name_company, phone from deliveries where code_delivery in (select code_delivery from purchases) order by code_delivery;
select * from purchases where cost*amount=(select cost*amount from purchases order by cost*amount desc limit 1) and not code_delivery in (select code_delivery from deliveries where address like '%ташкент%') order by code_purchase;
select c.title_book, a.date_order, b.name_company, a.type_purchase, a.cost, a.amount, a.code_purchase from purchases a join deliveries b on a.code_delivery=b.code_delivery join books c on a.code_book=c.code_book order by c.code_book;
select c.title_book, a.date_order, b.name_company, a.type_purchase, a.cost, a.amount, a.code_purchase from purchases a join deliveries b on a.code_delivery=b.code_delivery join books c on a.code_book=c.code_book where c.title_book like '_а%а' order by c.code_book;
select b.code_book, b.title_book, a.name_author, b.pages, p.publish from books b join authors a on b.code_author=a.code_author join publishing_house p on b.code_publish=p.code_publish where a.name_author like '%навои%' order by b.code_book
;
select substring_index(name_author, ' ', 1) as familiya from authors order by code_author desc limit 1;
select code_purchase from purchases where cost*amount=(select cost*amount from purchases order by cost*amount  limit 1) order by code_purchase;
select name_company from deliveries where code_delivery in(select code_delivery from purchases where cost*amount=(select cost*amount from purchases order by cost*amount desc limit 1)) order by name_company desc ;
select code_purchase from purchases where cost*amount=(select cost*amount from purchases order by cost*amount desc limit 1) order by code_purchase;
select name_company from deliveries where code_delivery in(select code_delivery from purchases where cost*amount=(select cost*amount from purchases order by cost*amount limit 1)) order by name_company;